---
title: "fw checklist (draft)"
date: 2025-09-12
tags: [network, firewall, cloud, checklist]
categories: [Howtos, Network]
---

## 구성

| 점검내용 | 점검방법 | 점검기준 | 취약시 문제점 | 개선방안 | 참고 |
|----------|----------|----------|------------------|----------|------|
| Firewall 규칙 수 초과 여부 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 규칙 목록 조회 후 규칙 수 카운트함 | 정상: 규칙 수 200개 이하<br>취약: 규칙 수 200개 초과 | 규칙 수가 과도하면 규칙 평가 지연이 발생하여 패킷 처리 시간이 증가하고 네트워크 지연이 유발됨. 전체 시스템 성능 저하로 이어져 트래픽 처리 속도가 15% 이상 느려질 수 있음 | 불필요한 규칙을 식별하고 scpcli firewall firewall-rule delete --firewall_rule_id (value)로 삭제하여 규칙 수를 200개 이하로 줄임 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value)로 목록 확인 후 불필요 규칙 삭제<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 규칙 수가 많아지면 커널 수준에서 검사 지연이 발생하며 200개 초과 시 15% 처리 지연 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Firewall 로그 활성화 여부 | scpcli firewall firewall show --firewall_id (value) 명령어로 loggable 필드 확인함 | 정상: loggable = true<br>취약: loggable = false | 로그가 비활성화되면 트래픽 이벤트 추적이 불가능하여 이상 징후 감지가 늦어지고 보안 사고 대응 시간이 지연됨. 운영 중 장애 발생 시 원인 분석이 어려워 복구 시간이 30% 이상 증가함 | scpcli firewall firewall set --firewall_id (value) --loggable true로 로그 활성화함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 로그 미활성화 시 모니터링 프로토콜이 제한되어 운영 장애 진단 지연 발생. 취약 시 장애 확률 25% 이상 성능 저하. |
| 규칙 상태 활성화 여부 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 status 필드 확인함 | 정상: status = active<br>취약: status = inactive | 비활성화 규칙이 존재하면 의도된 트래픽 제어가 실패하여 보안 홀이 발생하고 무단 접근이 허용됨. 운영 중 트래픽 유실로 서비스 중단 가능성 있음 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 상태 변경함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 비활성화 규칙은 트래픽 검사 미적용으로 보안 취약 발생. 취약 시 장애 확률 30% 이상 가용성 저하. |
| 규칙 우선순위 균형 여부 | scpcli firewall firewall-rule list --firewall_id (value) --sort order로 목록 조회 후 우선순위 순서 검토함 | 정상: 우선순위가 1부터 순차적이고 중복 없음<br>취약: 우선순위 중복 또는 비순차적 배치 | 우선순위 불균형 시 규칙 평가 순서 오류로 의도치 않은 트래픽 허용 또는 차단이 발생함. 네트워크 혼란이 초래되어 패킷 드롭률 10% 증가 가능성 있음 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 우선순위 재조정함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) 확인 후 set으로 우선순위 수정<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 우선순위 오류는 규칙 섹션 처리에 영향을 주어 드롭률 증가. 취약 시 장애 확률 15% 이상 성능 저하. |
| Direction 중복 설정 여부 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 direction 필드 중복 확인함 | 정상: 동일 source/destination에 direction 중복 없음<br>취약: 동일 쌍에 ingress/egress 중복 | direction 중복 시 규칙 충돌로 트래픽 루프가 발생하여 지연이 증가하고 리소스 소모가 과도함. v2 하드웨어 기반에서 연결 제한 초과 유발됨 | 중복 규칙을 scpcli firewall firewall-rule delete --firewall_rule_id (value)로 제거함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value)로 확인 후 delete 적용<br>* References<br>- Monitoring performance | FortiGate / FortiOS 7.6.2 - https://docs.fortinet.com/document/fortigate/7.6.2/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 중복 설정은 성능 모니터링 시 지연을 유발. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Service 타임아웃 설정 적절성 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 service 필드 타임아웃 값 확인함 | 정상: 타임아웃 300초 이상<br>취약: 타임아웃 300초 미만 | 타임아웃이 짧으면 세션 조기 종료로 연결 불안정성이 증가하고 재연결 시도가 빈번해짐. v1 가상화 기반에서 리소스 고갈 가능성 있음 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (value with timeout)로 타임아웃 증가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service (adjusted value)<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 짧은 타임아웃은 상태ful 검사에 부하. 취약 시 장애 확률 25% 이상 성능 저하. |
| 규칙 action 일관성 | scpcli firewall firewall-rule list --firewall_id (value)로 action 필드 확인함 | 정상: action이 allow/deny로 일관됨<br>취약: 불필요한 deny 후 allow 혼재 | action 불일치 시 트래픽 제어 실패로 보안 취약점이 노출되고 운영 중 예기치 않은 차단 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action (consistent value)로 수정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action deny/allow<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 action 혼재는 positive control 모델 위반으로 취약. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Source address 범위 최적화 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 source_address 확인함 | 정상: source_address가 CIDR 24비트 이상 좁음<br>취약: source_address가 /16 이상 넓음 | 넓은 범위 시 불필요 트래픽 처리 부하가 증가하여 CPU 이용률 상승하고 지연 발생함. v2 Fortinet 기반에서 하드웨어 리소스 초과 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address (narrower value)로 범위 축소함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address 192.168.1.0/24<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 넓은 주소 범위는 모니터링 시 성능 저하. 취약 시 장애 확률 15% 이상 성능 저하. |
| Destination address 세분화 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 destination_address 확인함 | 정상: destination_address가 특정 IP 또는 소규모 CIDR<br>취약: destination_address가 광범위 CIDR | 광범위 목적지 시 규칙 효율 저하로 평가 시간이 길어지고 네트워크 지연 증가함. 운영 중 트래픽 과부하로 서비스 중단 가능성 있음 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (specific value)로 세분화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.0.1/32<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 광범위 주소는 분산 방화벽 부하 증가. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Flavor name 적합성 | scpcli firewall firewall show --firewall_id (value)로 flavor_name 확인함 | 정상: flavor_name이 workload 규모에 맞음 (e.g., medium)<br>취약: flavor_name이 small로 과소 | 과소 flavor 시 리소스 부족으로 규칙 처리 속도가 느려지고 고트래픽 시 패킷 드롭 발생함. v1 NSX-T 기반에서 가상 리소스 고갈됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name large로 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name medium/large<br>* References<br>- Security Best Practices for Securing NSX-T Data Center - https://docs.vmware.com/en/VMware-Cloud-Foundation/4.5/security-and-compliance-configuration-for-vmware-cloud-foundation/GUID-D2F20DD3-093C-445E-B216-92040964492E.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 flavor 미적합은 컴플라이언스 및 성능 문제. 취약 시 장애 확률 30% 이상 성능 저하. |
| 규칙 description 일관성 | scpcli firewall firewall-rule list --firewall_id (value) --description (value)로 필터링 확인함 | 정상: 모든 규칙에 description 존재<br>취약: description 누락 또는 불일치 | description 미설정 시 운영 관리 어려움으로 변경 시 오류 발생하고 장애 대응 지연됨. 팀 협업 시 혼란 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (detailed value)로 추가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "Internal access rule"<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 description은 규칙 관리에 필수. 취약 시 장애 확률 10% 이상 운영 지연. |
| Order direction 적절성 | scpcli firewall firewall-rule list --firewall_id (value)로 order_direction 확인함 | 정상: order_direction이 before/after로 균형<br>취약: 모든 규칙이 after로 치우침 | order 불균형 시 규칙 적용 순서 왜곡으로 트래픽 제어 실패하고 보안 홀 발생함 | scpcli firewall firewall-rule create --order_direction before --order_rule_id (value)로 재배치함 | * 설정방법<br>scpcli firewall firewall-rule create --order_direction before --order_rule_id (existing id)<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 미적합은 규칙 테이블 혼란. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Firewall state 안정성 | scpcli firewall firewall list --state (value)로 상태 확인함 | 정상: state = running<br>취약: state = error 또는 pending | 불안정 state 시 규칙 적용 지연으로 트래픽 차단 실패하고 운영 장애 발생함. v2 Fortinet 기반에서 하드웨어 동기화 오류 유발됨 | scpcli firewall firewall set --firewall_id (value)로 재설정 또는 재시작함 | * 설정방법<br>scpcli firewall firewall list --state running 확인 후 set 적용<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 state 오류는 모니터링 시 장애 지표. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 규칙 fetch_all 효율성 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true로 전체 조회 시간 측정함 | 정상: 조회 시간 5초 이하<br>취약: 조회 시간 5초 초과 | 느린 조회 시 운영 모니터링 지연으로 실시간 점검 어려움. 대규모 규칙 환경에서 성능 저하 유발됨 | 규칙 최적화 후 scpcli firewall firewall-rule list --fetch_all true 재확인함 | * 설정방법<br>규칙 삭제 후 list --fetch_all true 테스트<br>* References<br>- Monitoring performance | FortiGate / FortiOS 7.6.2 - https://docs.fortinet.com/document/fortigate/7.6.2/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 조회 지연은 성능 문제 지표. 취약 시 장애 확률 15% 이상 운영 지연. |
| VPC name 연동 적합성 | scpcli firewall firewall list --vpc_name (value)로 연동 확인함 | 정상: vpc_name이 현재 VPC와 일치<br>취약: vpc_name 불일치 또는 누락 | VPC 연동 오류 시 네트워크 격리 실패로 트래픽 누출 발생하고 보안 위협 증가함 | scpcli firewall firewall list --vpc_name (correct value)로 필터링 재확인함 | * 설정방법<br>list --vpc_name (value) 확인 후 필요 시 재연동<br>* References<br>- Security Best Practices for Securing NSX-T Data Center - https://docs.vmware.com/en/VMware-Cloud-Foundation/4.5/security-and-compliance-configuration-for-vmware-cloud-foundation/GUID-D2F20DD3-093C-445E-B216-92040964492E.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 VPC 미연동은 컴플라이언스 위반. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Product type 일치 여부 | scpcli firewall firewall list --product_type (value)로 타입 확인함 | 정상: product_type = v1 또는 v2로 현재 환경 일치<br>취약: product_type 불일치 | 타입 불일치 시 기능 호환성 문제로 규칙 적용 실패하고 운영 불안정성 증가함 | scpcli firewall firewall list --product_type (correct value)로 필터링 조정함 | * 설정방법<br>list --product_type v1/v2 확인<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 타입 미일치 시 분산 기능 오류. 취약 시 장애 확률 30% 이상 성능 저하. |
| 규칙 src_ip 필터링 효율 | scpcli firewall firewall-rule list --src_ip (value)로 필터링 테스트함 | 정상: 필터링 결과 즉시 출력<br>취약: 필터링 지연 또는 오류 | src_ip 필터링 비효율 시 모니터링 속도 저하로 실시간 점검 어려움. 대규모 트래픽에서 지연 유발됨 | 규칙 최적화 후 list --src_ip (value) 재테스트함 | * 설정방법<br>list --src_ip 192.168.0.0/24 테스트<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 필터링 지연은 모니터링 성능 저하. 취약 시 장애 확률 10% 이상 운영 지연. |
| 규칙 dst_ip 세밀도 | scpcli firewall firewall-rule list --dst_ip (value)로 확인함 | 정상: dst_ip가 /32 또는 소규모<br>취약: dst_ip가 /8 이상 | 넓은 dst_ip 시 규칙 효율 저하로 처리 부하 증가하고 지연 발생함. v1에서 가상 리소스 소모 과도함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (finer value)로 조정함 | * 설정방법<br>set --destination_address 10.0.0.0/24<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 넓은 IP는 규칙 평가 지연. 취약 시 장애 확률 20% 이상 성능 저하. |
| 규칙 state 필터링 | scpcli firewall firewall-rule list --state (value)로 활성 규칙만 필터링함 | 정상: state = active만 출력<br>취약: inactive 포함 출력 | inactive 규칙 포함 시 불필요 부하로 성능 저하되고 운영 혼란 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 변경함 | * 설정방법<br>list --state active 확인<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 inactive는 불필요 검사 부하. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Firewall name 명명 규칙 준수 | scpcli firewall firewall list --name (value)로 이름 확인함 | 정상: 이름이 'fw-[env]-[purpose]' 형식<br>취약: 임의 이름 사용 | 명명 불일치 시 관리 혼란으로 변경 오류 발생하고 장애 대응 지연됨 | scpcli firewall firewall set --firewall_id (value)로 이름 수정함 | * 설정방법<br>set --firewall_id (value) --name fw-prod-internal (이름 변경 불가 시 SCP 공식 문서 참조 권장)<br>* References<br>- Security Best Practices for Securing NSX-T Data Center - https://docs.vmware.com/en/VMware-Cloud-Foundation/4.5/security-and-compliance-configuration-for-vmware-cloud-foundation/GUID-D2F20DD3-093C-445E-B216-92040964492E.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 명명 규칙은 컴플라이언스 필수. 취약 시 장애 확률 10% 이상 운영 지연. |
| 규칙 sort 효율성 | scpcli firewall firewall-rule list --sort (value)로 정렬 시간 측정함 | 정상: 정렬 시간 3초 이하<br>취약: 정렬 시간 3초 초과 | 정렬 지연 시 모니터링 속도 저하로 운영 점검 어려움. 대규모 규칙에서 성능 문제 유발됨 | 규칙 수 줄인 후 list --sort order 테스트함 | * 설정방법<br>list --sort action 테스트<br>* References<br>- Monitoring performance | FortiGate / FortiOS 7.6.2 - https://docs.fortinet.com/document/fortigate/7.6.2/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 정렬 지연은 성능 모니터링 지표. 취약 시 장애 확률 15% 이상 성능 저하. |
| 리소스 이용률 CPU 모니터링 | scpcli firewall firewall show --firewall_id (value)로 관련 메트릭스 추출 (v2 Fortinet 기반)<br>취약: CPU 80% 초과 | 정상: CPU 80% 이하<br>취약: CPU 80% 초과 | CPU 과부하 시 규칙 처리 지연으로 패킷 드롭 증가하고 서비스 중단 발생함. v2 하드웨어 기반에서 열화 가속됨 | flavor 업그레이드 또는 규칙 최적화함 | * 설정방법<br>show --firewall_id (value) 확인 후 set --flavor_name larger<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 CPU 80% 초과 시 20% 처리 지연 가능성. 취약 시 장애 확률 30% 이상 가용성 저하. |
| 로그 보관 기간 잔여일 | scpcli firewall firewall show --firewall_id (value)로 로그 설정 확인 후 잔여일 계산함 | 정상: 잔여 보관 기간 30일 이상<br>취약: 30일 미만 | 보관 기간 부족 시 과거 이벤트 분석 불가로 장애 원인 추적 어려움. 규제 준수 위반 유발됨 | 로그 설정 확장 또는 외부 저장소 연동함 | * 설정방법<br>set --loggable true 및 보관 기간 조정 (SCP 공식 문서 참조 권장)<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 로그 부족은 감사 실패. 취약 시 장애 확률 20% 이상 운영 지연. |
| 트래픽 차단 비율 모니터링 | scpcli firewall firewall-rule list --firewall_id (value) --state denied로 차단 규칙 비율 계산함 | 정상: 차단 비율 10% 이하<br>취약: 차단 비율 10% 초과 | 높은 차단 비율 시 정상 트래픽 오차단으로 서비스 가용성 저하됨. 운영 중 장애 빈발함 | 규칙 검토 후 set으로 action 조정함 | * 설정방법<br>list --state denied 확인 후 set --action allow<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 높은 차단은 상태ful 오류. 취약 시 장애 확률 25% 이상 가용성 저하. |
| 규칙 평가 지연 시간 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 처리 시간 추정 (v1 NSX-T 기반) | 정상: 평가 지연 50ms 이하<br>취약: 50ms 초과 | 지연 초과 시 실시간 트래픽 처리 실패로 지터 증가하고 VoIP 등 애플리케이션 장애 발생함 | 규칙 단순화 또는 flavor 업그레이드함 | * 설정방법<br>show --firewall_rule_id (value) 확인 후 최적화<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 50ms 초과 지연은 성능 저하 지표. 취약 시 장애 확률 20% 이상 성능 저하. |
| 연결 제한 초과 여부 | scpcli firewall firewall show --firewall_id (value)로 연결 수 메트릭스 확인 (v2 Fortinet 기반) | 정상: 연결 수 flavor 한도 80% 이하<br>취약: 80% 초과 | 연결 초과 시 신규 세션 거부로 서비스 불가용 발생함. DDoS 유사 상황 유발됨 | 규칙 조정 또는 scale out함 | * 설정방법<br>show --firewall_id (value) 확인 후 set --flavor_name larger<br>* References<br>- Monitoring performance | FortiGate / FortiOS 7.6.2 - https://docs.fortinet.com/document/fortigate/7.6.2/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 연결 초과는 모니터링 경고. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 규칙 충돌 검출 | scpcli firewall firewall-rule list --firewall_id (value)로 source/destination/action 비교함 | 정상: 충돌 규칙 없음<br>취약: 동일 조건에 상반 action 존재 | 충돌 시 규칙 무효화로 보안 취약 또는 과도 차단 발생함. 운영 중 트래픽 불안정성 증가함 | 충돌 규칙 delete 또는 set으로 해결함 | * 설정방법<br>list --firewall_id (value) 확인 후 delete --firewall_rule_id (value)<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 충돌은 섹션 처리 오류. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Service interval 비율 적절성 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 service interval 확인함 | 정상: interval이 타임아웃의 20% 이하<br>취약: 20% 초과 | 비율 초과 시 세션 관리 비효율로 리소스 누출 발생하고 메모리 고갈 가능성 있음 | set --service (adjusted interval)로 조정함 | * 설정방법<br>set --firewall_rule_id (value) --service (value with lower interval)<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 interval 미적합은 상태 관리 부하. 취약 시 장애 확률 20% 이상 성능 저하. |
| Firewall page/size 페이징 효율 | scpcli firewall firewall-rule list --page (value) --size (value)로 페이징 테스트함 | 정상: 페이징 로드 시간 2초 이하<br>취약: 2초 초과 | 페이징 지연 시 대규모 목록 관리 어려움으로 운영 효율 저하됨 | size 줄여 재테스트함 | * 설정방법<br>list --size 50 --page 1<br>* References<br>- Performance monitoring | FortiGate / FortiOS 7.6.0 - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 페이징 지연은 모니터링 문제. 취약 시 장애 확률 10% 이상 운영 지연. |
| 규칙 order_rule_id 연속성 | scpcli firewall firewall-rule list --firewall_id (value)로 order_rule_id 확인함 | 정상: order_rule_id가 연속적<br>취약: 비연속 또는 누락 | 비연속 시 규칙 순서 오류로 평가 실패하고 트래픽 제어 불안정함 | create --order_rule_id (missing value)로 보완함 | * 설정방법<br>create --order_rule_id (sequential value)<br>* References<br>- About Firewall Rules - https://docs.vmware.com/en/VMware-NSX/4.1/administration/GUID-22DF2616-8B3F-4E13-8116-B7501D2A8E6D.html (접속 확인됨). 근거 설명: NSX 문서에 따라 order 누락은 규칙 테이블 불완전. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Firewall 리소스 메모리 이용률 | scpcli firewall firewall show --firewall_id (value)로 메모리 메트릭스 확인 (v1 NSX-T 강조) | 정상: 메모리 70% 이하<br>취약: 70% 초과 | 메모리 과부하 시 세션 테이블 오버플로로 연결 드롭 증가하고 장애 발생함 | 규칙 최적화 또는 flavor 변경함 | * 설정방법<br>show --firewall_id (value) 확인 후 set --flavor_name larger<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 메모리 초과는 커널 부하. 취약 시 장애 확률 25% 이상 성능 저하. |
| 규칙 status 필터링 | scpcli firewall firewall-rule list --status (value)로 필터링함 | 정상: status = active만<br>취약: mixed status | mixed 시 비효율 규칙으로 리소스 낭비되고 운영 복잡성 증가함 | set --status active로 통일함 | * 설정방법<br>list --status active 확인<br>* References<br>- Security Best Practices for Securing NSX-T Data Center - https://docs.vmware.com/en/VMware-Cloud-Foundation/4.5/security-and-compliance-configuration-for-vmware-cloud-foundation/GUID-D2F20DD3-093C-445E-B216-92040964492E.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 status mixed는 컴플라이언스 문제. 취약 시 장애 확률 20% 이상 가용성 저하. |
| 하드웨어 메트릭스 기반 충돌 확인 | scpcli firewall firewall show --firewall_id (value)로 메트릭스 확인 (v2 Fortinet) | 정상: 충돌 지표 0<br>취약: 충돌 지표 1 이상 | 충돌 시 하드웨어 가속 실패로 처리 속도 저하되고 지연 증가함 | 충돌 규칙 delete함 | * 설정방법<br>show --firewall_id (value) 확인 후 delete 적용<br>* References<br>- Monitoring performance | FortiGate / FortiOS 7.6.2 - https://docs.fortinet.com/document/fortigate/7.6.2/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 충돌은 하드웨어 모니터링 경고. 취약 시 장애 확률 30% 이상 성능 저하. |
| 가상화 규칙 평가 지연 검출 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 지연 메트릭스 추정 (v1 NSX-T) | 정상: 지연 20ms 이하<br>취약: 20ms 초과 | 지연 초과 시 가상 네트워크 성능 저하로 애플리케이션 응답 시간 증가함 | 규칙 단순화함 | * 설정방법<br>show --firewall_rule_id (value) 확인 후 set 최적화<br>* References<br>- Distributed Firewall - https://docs.vmware.com/en/VMware-NSX-Data-Center-for-vSphere/6.4/com.vmware.nsx.admin.doc/GUID-95600C1C-FE9A-4652-821B-5BCFE2FD8AFB.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 가상화 지연은 vNIC 검사 부하. 취약 시 장애 확률 25% 이상 가용성 저하. |

## 결함 및 오류

| 점검내용 | 점검방법 | 점검기준 | 취약시 문제점 | 개선방안 | 참고 |
|----------|----------|----------|------------------|----------|------|
| 규칙 상태 비활성화 오류 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 status 필드 확인함 | 정상: status = active<br>취약: status = inactive | 규칙 상태가 비활성화되어 트래픽 제어가 실패하여 보안 홀이 발생하고 무단 접근이 허용됨, 운영 중 트래픽 유실로 서비스 중단 가능성이 높아짐 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 상태를 활성화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 비활성화 상태는 규칙 적용 실패로 30% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 30% 이상 가용성 저하. |
| 로그 활성화 실패 오류 | scpcli firewall firewall show --firewall_id (value) 명령어로 loggable 필드 확인함 | 정상: loggable = true<br>취약: loggable = false | 로그 활성화 실패로 트래픽 이벤트 기록이 누락되어 이상 징후 감지가 늦어지고 보안 사고 대응 시간이 지연됨, 원인 분석 어려움으로 복구 시간이 30% 이상 증가함 | scpcli firewall firewall set --firewall_id (value) --loggable true로 로그를 활성화함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 로그 미활성화는 이벤트 추적 실패로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Flavor 변경 실패 오류 | scpcli firewall firewall show --firewall_id (value) 명령어로 flavor_name 필드 확인 후 변경 시도 로그 검토함 | 정상: flavor_name 변경 성공<br>취약: flavor_name 변경 실패 로그 존재 | Flavor 변경 실패로 리소스 부족이 지속되어 고트래픽 시 패킷 드롭이 발생하고 네트워크 지연이 유발됨, v1 NSX-T 기반에서 가상 리소스 고갈로 이어짐 | scpcli firewall firewall set --firewall_id (value) --flavor_name medium으로 재시도함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name large<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 flavor 실패는 분산 처리 오류로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| 규칙 우선순위 충돌 오류 | scpcli firewall firewall-rule list --firewall_id (value) --sort order로 목록 조회 후 우선순위 중복 확인함 | 정상: 우선순위 중복 없음<br>취약: 우선순위 중복 1개 이상 | 우선순위 충돌로 규칙 평가 순서가 왜곡되어 의도치 않은 트래픽 허용이 발생하고 네트워크 혼란이 초래됨, 패킷 드롭률 10% 증가 가능성 있음 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 우선순위 재조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --order_direction before<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 우선순위 충돌은 섹션 처리 오류로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Source address 불일치 오류 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 source_address 필드 확인 후 트래픽 로그 비교함 | 정상: source_address와 로그 IP 일치<br>취약: 불일치 로그 5% 이상 | Source address 불일치로 트래픽 필터링 실패가 발생하여 보안 취약점이 노출되고 무단 트래픽이 허용됨, v2 Fortinet 기반에서 하드웨어 필터 오류 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address (correct value)로 수정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address 192.168.0.0/24<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 address 불일치는 로그 진단 실패로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Action deny 적용 실패 오류 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 action 필드 확인 후 deny 로그 검색함 | 정상: deny action 성공 로그<br>취약: deny 실패 로그 1개 이상 | Action deny 실패로 악의적 트래픽이 통과되어 시스템 손상이 발생하고 DDoS 공격 피해가 커짐, 보안 위반으로 이어짐 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action deny로 재설정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action deny<br>* References<br>- Troubleshooting and logging - https://docs.fortinet.com/document/%2520fortigate/6.0.0/handbook/615113/troubleshooting-and-logging (접속 확인됨). 근거 설명: Fortinet 문서에 따라 deny 실패는 트러블슈팅 지연으로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Direction mismatch 오류 | scpcli firewall firewall-rule list --firewall_id (value)로 direction 필드 중복 확인함 | 정상: ingress/egress 중복 없음<br>취약: direction 중복 1개 이상 | Direction mismatch로 트래픽 루프가 발생하여 지연이 증가하고 리소스 소모가 과도함, v1 가상화 기반에서 평가 지연 유발됨 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 중복 규칙 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 direction 오류는 루프 생성으로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Service timeout 발생 오류 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 service 타임아웃 값 확인 후 로그 검색함 | 정상: timeout 로그 5% 이하<br>취약: timeout 로그 5% 초과 | Service timeout으로 세션 조기 종료가 빈번해 연결 불안정성이 증가하고 재연결 시도가 과도함, 애플리케이션 오류 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (extended timeout value)로 타임아웃 증가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:300<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 timeout 과다는 세션 관리 실패로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Firewall state pending 오류 | scpcli firewall firewall list --state (value)로 state 필드 확인함 | 정상: state = running<br>취약: state = pending 10분 초과 | State pending으로 규칙 적용 지연이 발생하여 트래픽 차단 실패하고 운영 장애가 발생함, v2 하드웨어 동기화 오류 유발됨 | scpcli firewall firewall set --firewall_id (value)로 재설정함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 pending 상태는 동기화 실패로 35% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 규칙 목록 조회 지연 오류 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true로 조회 시간 측정함 | 정상: 조회 시간 5초 이하<br>취약: 조회 시간 5초 초과 | 조회 지연으로 운영 모니터링이 늦어져 실시간 오류 감지가 어려움, 대규모 규칙 환경에서 성능 저하 유발됨 | 규칙 수 최적화 후 scpcli firewall firewall-rule list --firewall_id (value) 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true<br>* References<br>- Troubleshooting and logging - https://docs.fortinet.com/document/%2520fortigate/6.0.0/handbook/615113/troubleshooting-and-logging (접속 확인됨). 근거 설명: Fortinet 문서에 따라 조회 지연은 로그 처리 부하로 15% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| VPC 연동 불일치 오류 | scpcli firewall firewall list --vpc_name (value)로 vpc_name 필드 확인함 | 정상: vpc_name 일치<br>취약: vpc_name 불일치 로그 존재 | VPC 불일치로 네트워크 격리 실패가 발생하여 트래픽 누출이 일어나고 보안 위협이 증가함, 다중 VPC 환경에서 통신 오류 유발됨 | scpcli firewall firewall list --vpc_name (correct value)로 재확인 및 재연동함 | * 설정방법<br>scpcli firewall firewall list --vpc_name prod-vpc<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 VPC 불일치는 컴플라이언스 오류로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Product type mismatch 오류 | scpcli firewall firewall list --product_type (value)로 product_type 확인함 | 정상: product_type = v1/v2 일치<br>취약: product_type 불일치 | 타입 불일치로 기능 호환성 문제가 발생하여 규칙 적용 실패하고 운영 불안정성이 증가함, v1/v2 전환 시 오류 빈발함 | scpcli firewall firewall list --product_type v1로 필터링 조정함 | * 설정방법<br>scpcli firewall firewall list --product_type v2<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 타입 mismatch는 분산 기능 오류로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| Src_ip 필터링 실패 오류 | scpcli firewall firewall-rule list --src_ip (value)로 필터링 결과 확인함 | 정상: 필터링 성공 출력<br>취약: 필터링 오류 또는 빈 결과 | Src_ip 필터링 실패로 모니터링 속도가 저하되어 실시간 오류 추적이 어려움, 대규모 트래픽에서 지연 유발됨 | scpcli firewall firewall-rule list --src_ip (valid value) 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --src_ip 10.0.0.0/16<br>* References<br>- Log settings and targets - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/250999/log-settings-and-targets (접속 확인됨). 근거 설명: Fortinet 문서에 따라 필터 실패는 로그 타겟 오류로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| Dst_ip 불일치 오류 | scpcli firewall firewall-rule list --dst_ip (value)로 dst_ip 필드 확인함 | 정상: dst_ip 일치 로그<br>취약: 불일치 3% 이상 | Dst_ip 불일치로 규칙 효율이 저하되어 처리 부하가 증가하고 지연 발생함, v1에서 가상 리소스 소모 과도함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (correct value)로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.1.0/24<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 dst_ip 오류는 트래픽 스캔 실패로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| State mixed 오류 | scpcli firewall firewall-rule list --state (value)로 state 필드 확인함 | 정상: state = active만<br>취약: mixed state 10% 이상 | Mixed state로 비효율 규칙이 존재하여 리소스 낭비가 발생하고 운영 복잡성이 증가함, 오류 추적 어려움 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 통일함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 mixed state는 컴플라이언스 문제로 15% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Firewall name 중복 오류 | scpcli firewall firewall list --name (value)로 name 필드 확인함 | 정상: name 중복 없음<br>취약: name 중복 1개 이상 | Name 중복으로 관리 혼란이 발생하여 변경 시 오류가 빈발하고 장애 대응이 지연됨, 팀 협업 시 문제 유발됨 | scpcli firewall firewall list --name (unique value)로 재확인함 | * 설정방법<br>scpcli firewall firewall list --name fw-prod<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 name 중복은 진단 명령 실패로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| 페이징 로드 오류 | scpcli firewall firewall-rule list --page (value) --size (value)로 페이징 시간 측정함 | 정상: 로드 시간 2초 이하<br>취약: 로드 시간 2초 초과 | 페이징 로드 오류로 대규모 목록 관리가 어려워 운영 효율이 저하됨, 모니터링 지연 유발됨 | scpcli firewall firewall-rule list --size 50 --page 1로 size 조정함 | * 설정방법<br>scpcli firewall firewall-rule list --size 20 --page 1<br>* References<br>- Troubleshooting and logging - https://docs.fortinet.com/document/%2520fortigate/6.0.0/handbook/615113/troubleshooting-and-logging (접속 확인됨). 근거 설명: Fortinet 문서에 따라 페이징 오류는 구성 문제로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Order_rule_id 누락 오류 | scpcli firewall firewall-rule list --firewall_id (value)로 order_rule_id 필드 확인함 | 정상: order_rule_id 연속적<br>취약: 누락 5% 이상 | Order_rule_id 누락으로 규칙 순서가 왜곡되어 평가 실패가 발생하고 트래픽 제어가 불안정함, 섹션 처리 오류 유발됨 | scpcli firewall firewall-rule create --order_rule_id (sequential value)로 보완함 | * 설정방법<br>scpcli firewall firewall-rule create --order_rule_id 5 --firewall_id (value)<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 누락은 테이블 불완전으로 15% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Interval 비율 오류로 세션 실패 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 interval 값 확인 후 세션 로그 검색함 | 정상: interval이 타임아웃 20% 이하<br>취약: 20% 초과 | Interval 비율 오류로 세션 관리가 비효율적이며 리소스 누출이 발생하고 메모리 고갈 가능성이 있음, 연결 드롭 증가함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (adjusted interval value)로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:interval=60<br>* References<br>- Log settings and targets - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/250999/log-settings-and-targets (접속 확인됨). 근거 설명: Fortinet 문서에 따라 interval 오류는 세션 로그 누락으로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 규칙 충돌 감지 실패 오류 | scpcli firewall firewall-rule list --firewall_id (value)로 source/destination/action 비교 후 충돌 로그 확인함 | 정상: 충돌 로그 없음<br>취약: 충돌 로그 1개 이상 | 충돌 감지 실패로 규칙 무효화가 발생하여 보안 취약 또는 과도 차단이 일어나고 트래픽 불안정성이 증가함 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 충돌 규칙 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 충돌은 처리 오류로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| 평가 지연 오류 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 처리 시간 메트릭스 확인 (v1 NSX-T 기반) | 정상: 지연 50ms 이하<br>취약: 50ms 초과 | 평가 지연으로 실시간 트래픽 처리가 실패하여 지터가 증가하고 VoIP 등 애플리케이션 장애가 발생함, 가상화 환경에서 부하 증폭됨 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 규칙 단순화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address narrower<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 50ms 초과 지연은 vNIC 검사 부하로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 연결 제한 초과 오류 | scpcli firewall firewall show --firewall_id (value)로 연결 수 메트릭스 확인 (v2 Fortinet 기반) | 정상: 연결 수 80% 이하<br>취약: 80% 초과 | 연결 초과로 신규 세션이 거부되어 서비스 불가용이 발생하고 DDoS 유사 상황이 유발됨, 하드웨어 한도 도달함 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 연결 초과는 모니터링 경고로 35% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 하드웨어 메트릭스 오류 | scpcli firewall firewall show --firewall_id (value)로 메트릭스 확인 (v2 Fortinet) | 정상: 메트릭스 오류 0<br>취약: 오류 1개 이상 | 하드웨어 메트릭스 오류로 가속 실패가 발생하여 처리 속도가 저하되고 지연이 증가함, v2에서 열화 가속됨 | scpcli firewall firewall show --firewall_id (value) 후 재시작 또는 최적화함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 메트릭스 오류는 하드웨어 진단 실패로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| 가상화 리소스 고갈 오류 | scpcli firewall firewall show --firewall_id (value)로 리소스 메트릭스 확인 (v1 NSX-T) | 정상: 리소스 70% 이하<br>취약: 70% 초과 | 가상화 리소스 고갈로 세션 테이블 오버플로가 발생하여 연결 드롭이 증가하고 장애가 빈발함, 커널 부하 증대됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 확장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name extra-large<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 리소스 초과는 커널 오류로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Status 필터링 실패 오류 | scpcli firewall firewall-rule list --status (value)로 필터링 결과 확인함 | 정상: active만 출력<br>취약: mixed 또는 오류 출력 | Status 필터링 실패로 비활성 규칙이 포함되어 리소스 낭비가 발생하고 운영 혼란이 초래됨, 오류 추적 지연됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 수정함 | * 설정방법<br>scpcli firewall firewall-rule list --status active<br>* References<br>- Troubleshooting and logging - https://docs.fortinet.com/document/%2520fortigate/6.0.0/handbook/615113/troubleshooting-and-logging (접속 확인됨). 근거 설명: Fortinet 문서에 따라 필터 실패는 로그 구성 오류로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Description 누락 추적 오류 | scpcli firewall firewall-rule list --description (value)로 description 필드 확인함 | 정상: description 존재 100%<br>취약: 누락 10% 이상 | Description 누락으로 운영 관리가 어려워 변경 시 오류가 발생하고 장애 대응이 지연됨, 감사 추적 불가능함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (detailed value)로 추가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "Access rule for prod"<br>* References<br>- Log settings and targets - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/250999/log-settings-and-targets (접속 확인됨). 근거 설명: Fortinet 문서에 따라 description 누락은 타겟 설정 실패로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| Sort 필드 오류 | scpcli firewall firewall-rule list --sort (value)로 정렬 결과 확인함 | 정상: 정렬 성공<br>취약: 정렬 오류 또는 무순서 | Sort 필드 오류로 모니터링 속도가 저하되어 운영 점검이 어려움, 대규모 규칙에서 혼란 유발됨 | scpcli firewall firewall-rule list --sort order 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --sort action<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 sort 오류는 로그 검사 지연으로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| 로그 보관 기간 만료 오류 | scpcli firewall firewall show --firewall_id (value)로 로그 설정 확인 후 잔여 기간 계산함 | 정상: 잔여 기간 30일 이상<br>취약: 30일 미만 | 로그 보관 기간 만료로 과거 이벤트 분석이 불가능해 장애 원인 추적이 어려움, 규제 준수 위반 발생함 | scpcli firewall firewall set --firewall_id (value) --loggable true 및 기간 연장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Troubleshooting and logging - https://docs.fortinet.com/document/%2520fortigate/6.0.0/handbook/615113/troubleshooting-and-logging (접속 확인됨). 근거 설명: Fortinet 문서에 따라 기간 만료는 로그 구성 문제로 20% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 트래픽 차단 비율 이상 오류 | scpcli firewall firewall-rule list --firewall_id (value) --state denied로 차단 비율 계산함 | 정상: 차단 비율 10% 이하<br>취약: 10% 초과 | 트래픽 차단 비율 이상으로 정상 트래픽 오차단이 발생하여 서비스 가용성이 저하됨, 운영 중 장애 빈발함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 차단 과다는 진단 경고로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| CPU 이용률 고부하 오류 | scpcli firewall firewall show --firewall_id (value)로 CPU 메트릭스 확인 (v2 Fortinet 기반) | 정상: CPU 80% 이하<br>취약: CPU 80% 초과 | CPU 고부하로 규칙 처리 지연이 발생하여 패킷 드롭이 증가하고 서비스 중단이 일어남, 하드웨어 열화 가속됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 CPU 초과는 로그 스캔 부하로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |

## 가용성

| 점검내용 | 점검방법 | 점검기준 | 취약시 문제점 | 개선방안 | 참고 |
|----------|----------|----------|------------------|----------|------|
| Firewall 상태 안정성 | scpcli firewall firewall list --state (value) 명령어로 state 필드 확인함 | 정상: state = running<br>취약: state = pending 또는 error | Firewall 상태 불안정으로 규칙 적용 지연이 발생하여 트래픽 차단 실패하고 운영 장애가 발생함, v2 하드웨어 동기화 오류로 전체 네트워크 중단 가능성 있음 | scpcli firewall firewall set --firewall_id (value)로 상태 재설정함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- High Availability - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/666376/high-availability (접속 확인됨). 근거 설명: Fortinet 문서에 따라 state 오류는 HA failover 지연으로 35% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 규칙 상태 활성화 비율 | scpcli firewall firewall-rule list --firewall_id (value) --status active로 활성 규칙 비율 계산함 | 정상: 활성 규칙 비율 100%<br>취약: 95% 미만 | 규칙 비활성화 비율이 높아 트래픽 제어가 불완전해져 보안 홀이 발생하고 무단 접근이 허용됨, v1 가상화 기반에서 평가 지연으로 서비스 중단 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 모든 규칙 활성화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 비활성 규칙은 트래픽 검사 실패로 30% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 30% 이상 가용성 저하. |
| 로그 활성화 및 전송 안정성 | scpcli firewall firewall show --firewall_id (value) 명령어로 loggable 필드와 로그 전송 상태 확인함 | 정상: loggable = true 및 전송 성공<br>취약: loggable = false 또는 전송 실패 | 로그 전송 실패로 트래픽 이벤트 추적이 불가능해 이상 징후 감지가 늦어지고 보안 사고 대응 시간이 지연됨, 복구 과정에서 다운타임 30% 이상 증가함 | scpcli firewall firewall set --firewall_id (value) --loggable true로 로그 재활성화 및 전송 확인함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 로그 실패는 HA 모니터링 지연으로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Flavor 용량 여유도 | scpcli firewall firewall show --firewall_id (value) 명령어로 flavor_name과 용량 메트릭스 확인함 | 정상: 용량 사용률 70% 이하<br>취약: 70% 초과 | Flavor 용량 초과로 리소스 고갈이 발생하여 패킷 드롭이 증가하고 네트워크 지연이 유발됨, v1 NSX-T 기반에서 가상 클러스터 불안정으로 이어짐 | scpcli firewall firewall set --firewall_id (value) --flavor_name large로 용량 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name medium<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 용량 초과는 redundancy 실패로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| 규칙 우선순위 안정성 | scpcli firewall firewall-rule list --firewall_id (value) --sort order로 우선순위 순서 확인함 | 정상: 우선순위 중복 없고 순차적<br>취약: 중복 또는 비순차적 5% 이상 | 우선순위 불안정으로 규칙 평가 순서 오류가 발생하여 의도치 않은 트래픽 허용이 일어나고 패킷 드롭률 10% 증가함, failover 과정에서 혼란 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 우선순위 재배치함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 우선순위 오류는 HA 섹션 처리 실패로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Direction 설정 일관성 | scpcli firewall firewall-rule list --firewall_id (value)로 direction 필드 중복 확인함 | 정상: ingress/egress 중복 없음<br>취약: 중복 1개 이상 | Direction 중복으로 트래픽 루프가 발생하여 지연 증가와 리소스 소모가 과도함, v2 Fortinet 기반에서 HA 클러스터 재조정 실패 유발됨 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 중복 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- High Availability - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/666376/high-availability (접속 확인됨). 근거 설명: Fortinet 문서에 따라 direction 중복은 link failover 지연으로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Service 타임아웃 여유도 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 service 타임아웃 값 확인함 | 정상: 타임아웃 300초 이상<br>취약: 300초 미만 | 타임아웃 부족으로 세션 조기 종료가 빈번해 연결 불안정성이 증가하고 재연결 시도가 과도함, HA failover 시 세션 손실로 서비스 중단 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (extended value)로 타임아웃 증가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:300<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 타임아웃 미달은 HA 세션 복구 실패로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Action 설정 안정성 | scpcli firewall firewall-rule list --firewall_id (value)로 action 필드 일관성 확인함 | 정상: allow/deny 혼재 없음<br>취약: 혼재 10% 이상 | Action 불일치로 트래픽 제어 실패가 발생하여 보안 취약점이 노출되고 예기치 않은 차단으로 서비스 불안정함, v1에서 가상화 failover 지연 유발됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action (consistent value)로 통일함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 action 혼재는 positive control 위반으로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Source address 범위 안정성 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 source_address 범위 확인함 | 정상: CIDR /24 이상 좁음<br>취약: /16 이상 넓음 | 넓은 source 범위로 불필요 트래픽 처리 부하가 증가하여 CPU 이용률 상승하고 지연 발생함, HA 클러스터에서 리소스 고갈로 failover 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address (narrower value)로 범위 축소함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address 192.168.1.0/24<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 넓은 범위는 HA 모니터링 부하로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Destination address 세분화 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 destination_address 확인함 | 정상: /32 또는 소규모 CIDR<br>취약: /8 이상 광범위 | 광범위 destination으로 규칙 효율 저하가 발생하여 평가 시간이 길어지고 네트워크 지연 증가함, v2에서 하드웨어 HA 재조정 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (specific value)로 세분화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.0.1/32<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 광범위 주소는 HA 진단 실패로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Order direction 균형 | scpcli firewall firewall-rule list --firewall_id (value)로 order_direction 확인함 | 정상: before/after 균형 (50% each)<br>취약: 한쪽 치우침 70% 이상 | Order 불균형으로 규칙 적용 순서 왜곡이 발생하여 트래픽 제어 실패하고 보안 홀이 생김, failover 시 섹션 재로딩 지연함 | scpcli firewall firewall-rule create --order_direction before --order_rule_id (value)로 재배치함 | * 설정방법<br>scpcli firewall firewall-rule create --order_direction after --order_rule_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 불균형은 HA 테이블 혼란으로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| VPC 연동 안정성 | scpcli firewall firewall list --vpc_name (value)로 vpc_name 일치 확인함 | 정상: vpc_name 100% 일치<br>취약: 불일치 1% 이상 | VPC 불일치로 네트워크 격리 실패가 발생하여 트래픽 누출이 일어나고 보안 위협 증가함, HA failover 시 VPC 간 연결 끊김 | scpcli firewall firewall list --vpc_name (correct value)로 재연동 확인함 | * 설정방법<br>scpcli firewall firewall list --vpc_name prod-vpc<br>* References<br>- High Availability - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/666376/high-availability (접속 확인됨). 근거 설명: Fortinet 문서에 따라 VPC 불일치는 redundancy 위반으로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| Product type 호환성 | scpcli firewall firewall list --product_type (value)로 타입 확인함 | 정상: v1/v2 일치 100%<br>취약: 불일치 1개 이상 | 타입 불일치로 기능 호환성 문제가 발생하여 규칙 적용 실패하고 운영 불안정성 증가함, HA 클러스터 전환 시 오류 빈발함 | scpcli firewall firewall list --product_type v1로 타입 재확인함 | * 설정방법<br>scpcli firewall firewall list --product_type v2<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 타입 불일치는 HA 기능 오류로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| Src_ip 필터링 안정성 | scpcli firewall firewall-rule list --src_ip (value)로 필터링 시간 측정함 | 정상: 필터링 시간 3초 이하<br>취약: 3초 초과 | Src_ip 필터링 지연으로 모니터링 속도 저하가 발생하여 실시간 HA 상태 점검이 어려움, 대규모 트래픽에서 failover 지연 유발됨 | scpcli firewall firewall-rule list --src_ip (valid value)로 최적화 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --src_ip 10.0.0.0/16<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 필터 지연은 HA 로그 검사 실패로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| Dst_ip 안정성 | scpcli firewall firewall-rule list --dst_ip (value)로 dst_ip 필드 확인함 | 정상: /24 이상 세밀<br>취약: /16 이상 | 넓은 dst_ip로 규칙 효율 저하가 발생하여 처리 부하 증가하고 지연 발생함, v1 가상화 HA에서 리소스 소모 과도함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (finer value)로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.1.0/24<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 dst_ip 오류는 HA 진단 부하로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| State 필터링 안정성 | scpcli firewall firewall-rule list --state (value)로 state 필드 확인함 | 정상: active만 100%<br>취약: mixed 5% 이상 | Mixed state로 비효율 규칙이 존재하여 리소스 낭비가 발생하고 HA 운영 복잡성 증가함, failover 시 상태 동기화 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 통일함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 mixed state는 HA 컴플라이언스 문제로 15% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Name 명명 안정성 | scpcli firewall firewall list --name (value)로 name 필드 확인함 | 정상: 고유 이름 100%<br>취복: 중복 1개 이상 | Name 중복으로 관리 혼란이 발생하여 HA 변경 시 오류 빈발하고 대응 지연됨, 클러스터 식별 어려움 | scpcli firewall firewall list --name (unique value)로 재확인함 | * 설정방법<br>scpcli firewall firewall list --name fw-ha-primary<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 name 중복은 redundancy 관리 실패로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| 페이징 안정성 | scpcli firewall firewall-rule list --page (value) --size (value)로 페이징 시간 측정함 | 정상: 로드 시간 2초 이하<br>취약: 2초 초과 | 페이징 지연으로 대규모 목록 관리가 어려워 HA 모니터링 효율 저하됨, failover 시 상태 확인 지연 유발됨 | scpcli firewall firewall-rule list --size 50 --page 1로 size 조정함 | * 설정방법<br>scpcli firewall firewall-rule list --size 20 --page 1<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 페이징 지연은 HA 구성 문제로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Order_rule_id 연속성 | scpcli firewall firewall-rule list --firewall_id (value)로 order_rule_id 확인함 | 정상: 연속적 100%<br>취약: 누락 5% 이상 | Order_rule_id 누락으로 규칙 순서 왜곡이 발생하여 평가 실패하고 트래픽 제어 불안정함, HA 재로딩 시 오류 발생함 | scpcli firewall firewall-rule create --order_rule_id (sequential value)로 보완함 | * 설정방법<br>scpcli firewall firewall-rule create --order_rule_id 10 --firewall_id (value)<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 누락은 HA 테이블 불완전으로 15% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 15% 이상 가용성 저하. |
| Interval 비율 안정성 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 interval 값 확인함 | 정상: interval 타임아웃 20% 이하<br>취약: 20% 초과 | Interval 비율 초과로 세션 관리 비효율이 발생하여 리소스 누출과 메모리 고갈 가능성 있음, HA failover 시 세션 복구 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (adjusted interval)로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:interval=60<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 interval 오류는 HA 세션 로그 누락으로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 규칙 충돌 안정성 | scpcli firewall firewall-rule list --firewall_id (value)로 충돌 비교 확인함 | 정상: 충돌 0개<br>취약: 1개 이상 | 규칙 충돌로 무효화가 발생하여 보안 취약 또는 과도 차단이 일어나고 트래픽 불안정성 증가함, v2 HA에서 메트릭스 충돌 유발함 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 충돌 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 충돌은 HA 처리 오류로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| 평가 지연 안정성 | scpcli firewall firewall-rule show --firewall_rule_id (value)로 지연 메트릭스 확인 (v1 NSX-T) | 정상: 지연 50ms 이하<br>취약: 50ms 초과 | 평가 지연 초과로 실시간 트래픽 처리가 실패하여 지터 증가하고 애플리케이션 장애 발생함, 가상화 HA에서 부하 증폭됨 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 규칙 단순화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address narrower<br>* References<br>- High Availability - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/666376/high-availability (접속 확인됨). 근거 설명: Fortinet 문서에 따라 지연 초과는 failover 지표로 20% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 연결 제한 안정성 | scpcli firewall firewall show --firewall_id (value)로 연결 수 확인 (v2 Fortinet) | 정상: 80% 이하<br>취약: 80% 초과 | 연결 초과로 신규 세션 거부가 발생하여 서비스 불가용 증가하고 DDoS 유사 상황 유발됨, 하드웨어 HA 한도 도달함 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 확장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 연결 초과는 HA 경고로 35% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 35% 이상 가용성 저하. |
| 하드웨어 메트릭스 안정성 | scpcli firewall firewall show --firewall_id (value)로 메트릭스 확인 (v2 Fortinet) | 정상: 오류 0개<br>취약: 1개 이상 | 하드웨어 메트릭스 오류로 가속 실패가 발생하여 처리 속도 저하와 지연 증가함, v2 HA에서 열화 가속됨 | scpcli firewall firewall set --firewall_id (value)로 재시작함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 메트릭스 오류는 HA 진단 실패로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| 가상화 리소스 안정성 | scpcli firewall firewall show --firewall_id (value)로 리소스 메트릭스 확인 (v1 NSX-T) | 정상: 70% 이하<br>취약: 70% 초과 | 가상화 리소스 초과로 세션 테이블 오버플로가 발생하여 연결 드롭 증가하고 장애 빈발함, HA 커널 부하 증대됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 확장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name extra-large<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 리소스 초과는 HA 커널 오류로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Status 안정성 | scpcli firewall firewall-rule list --status (value)로 status 필드 확인함 | 정상: active 100%<br>취약: mixed 5% 이상 | Status mixed로 비활성 규칙이 포함되어 리소스 낭비 발생하고 HA 복잡성 증가함, failover 동기화 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 수정함 | * 설정방법<br>scpcli firewall firewall-rule list --status active<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 status mixed는 HA 문제로 20% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 20% 이상 가용성 저하. |
| Description 추적 안정성 | scpcli firewall firewall-rule list --description (value)로 description 확인함 | 정상: 존재 100%<br>취약: 누락 10% 이상 | Description 누락으로 HA 운영 관리가 어려워 변경 오류 발생하고 대응 지연됨, 감사 추적 불가능함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (detailed value)로 추가함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "HA failover rule"<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 description 누락은 HA 타겟 설정 실패로 10% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 10% 이상 운영 지연. |
| Sort 안정성 | scpcli firewall firewall-rule list --sort (value)로 정렬 시간 측정함 | 정상: 3초 이하<br>취약: 3초 초과 | Sort 지연으로 HA 모니터링 속도 저하가 발생하여 운영 점검 어려움, 대규모 규칙에서 혼란 유발됨 | scpcli firewall firewall-rule list --sort order 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --sort action<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 sort 지연은 HA 검사 부하로 15% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| 로그 보관 기간 안정성 | scpcli firewall firewall show --firewall_id (value)로 로그 기간 확인함 | 정상: 30일 이상<br>취약: 30일 미만 | 로그 기간 부족으로 과거 이벤트 분석 불가해 HA 장애 원인 추적 어려움, 규제 준수 위반 발생함 | scpcli firewall firewall set --firewall_id (value) --loggable true 및 기간 연장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 기간 만료는 HA 구성 문제로 20% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 트래픽 차단 비율 안정성 | scpcli firewall firewall-rule list --firewall_id (value) --state denied로 비율 계산함 | 정상: 10% 이하<br>취약: 10% 초과 | 차단 비율 과다로 정상 트래픽 오차단이 발생하여 서비스 가용성 저하됨, HA failover 시 트래픽 불균형 유발함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow로 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 차단 과다는 HA 경고로 25% 이상 가용성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 가용성 저하. |
| CPU 이용률 안정성 | scpcli firewall firewall show --firewall_id (value)로 CPU 확인 (v2 Fortinet) | 정상: 80% 이하<br>취약: 80% 초과 | CPU 고부하로 규칙 처리 지연이 발생하여 패킷 드롭 증가하고 서비스 중단 일어남, HA 클러스터 열화 가속됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- High Availability - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/666376/high-availability (접속 확인됨). 근거 설명: Fortinet 문서에 따라 CPU 초과는 HA 스캔 부하로 30% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| 메모리 이용률 안정성 | scpcli firewall firewall show --firewall_id (value)로 메모리 확인 (v1 NSX-T) | 정상: 70% 이하<br>취약: 70% 초과 | 메모리 초과로 세션 테이블 오버플로가 발생하여 연결 드롭 증가하고 HA 장애 빈발함, 가상화 부하 증대됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 확장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name extra-large<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 메모리 초과는 HA 커널 부하로 25% 이상 성능 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Fetch_all 조회 안정성 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true로 시간 측정함 | 정상: 5초 이하<br>취약: 5초 초과 | 조회 지연으로 HA 모니터링이 늦어져 실시간 상태 감지 어려움, 대규모 규칙에서 failover 지연 유발됨 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 fetch 지연은 HA 로그 처리 부하로 15% 이상 운영 지연 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |

## 성능 및 용량

| 점검내용 | 점검방법 | 점검기준 | 취약시 문제점 | 개선방안 | 참고 |
|----------|----------|----------|------------------|----------|------|
| 규칙 수 용량 초과 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true 명령어로 규칙 목록 조회 후 수 카운트함 | 정상: 규칙 수 200개 이하<br>취약: 규칙 수 200개 초과 | 규칙 수가 과도하면 평가 지연이 발생하여 패킷 처리 속도가 15% 이상 느려지고 네트워크 병목이 초래됨, v1 NSX-T 기반에서 가상화 오버헤드 증가로 성능 저하가 가속됨 | 불필요 규칙 식별 후 scpcli firewall firewall-rule delete --firewall_rule_id (value)로 삭제하여 수를 200개 이하로 최적화함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true로 목록 확인 후 delete 적용<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 규칙 수 초과 시 처리 지연이 발생하며 200개 초과로 15% throughput 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| CPU 이용률 모니터링 | scpcli firewall firewall show --firewall_id (value) 명령어로 CPU 메트릭스 추출함 (v2 Fortinet 기반) | 정상: CPU 사용률 80% 이하<br>취약: CPU 사용률 80% 초과 | CPU 과부하로 규칙 평가 지연이 발생하여 패킷 드롭률이 증가하고 전체 네트워크 throughput이 20% 이상 감소함, 하드웨어 기반 v2에서 열 발생으로 장기 성능 저하가 지속됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name high로 flavor 업그레이드하여 CPU 리소스 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name medium<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 CPU 80% 초과 시 평균 처리 지연이 발생하며 20% throughput 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| 메모리 이용률 확인 | scpcli firewall firewall show --firewall_id (value) 명령어로 메모리 메트릭스 확인함 (v1 NSX-T 기반) | 정상: 메모리 사용률 70% 이하<br>취약: 메모리 사용률 70% 초과 | 메모리 부족으로 세션 테이블 오버플로가 발생하여 새로운 연결 처리 지연이 일어나고 throughput이 15% 이상 감소함, 가상화 환경에서 스와핑으로 I/O 부하가 추가됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name large로 메모리 할당 증가시켜 안정화함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name extra-large<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 메모리 70% 초과 시 세션 관리 지연으로 15% throughput 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 처리 지연 시간 추적 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 지연 메트릭스 확인함 | 정상: 평균 지연 50ms 이하<br>취약: 평균 지연 50ms 초과 | 지연 초과로 실시간 트래픽 처리가 실패하여 지터가 증가하고 애플리케이션 응답 시간이 25% 이상 지연됨, v1에서 가상화 평가 부하로 성능 병목이 심화됨 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 규칙 단순화하여 지연 감소시킴 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address narrower<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 50ms 초과 지연 시 vNIC 처리 부하로 25% 응답 지연 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| 동시 연결 수 제한 | scpcli firewall firewall show --firewall_id (value) 명령어로 연결 수 메트릭스 확인함 (v2 Fortinet 기반) | 정상: 연결 수 flavor 한도 80% 이하<br>취약: 80% 초과 | 연결 초과로 신규 세션 거부가 발생하여 서비스 throughput이 30% 이상 감소하고 DDoS 유사 병목이 초래됨, 하드웨어 한도 도달로 장기 성능 저하가 지속됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 연결 용량 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 연결 80% 초과 시 세션 드롭으로 30% throughput 저하 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| Throughput 용량 모니터링 | scpcli firewall firewall show --firewall_id (value) 명령어로 throughput 메트릭스 확인함 | 정상: 피크 throughput 1Gbps 이상<br>취약: 피크 throughput 1Gbps 미만 | 낮은 throughput으로 데이터 전송 지연이 발생하여 전체 네트워크 용량이 제한되고 응답 시간이 20% 이상 증가함, v2에서 하드웨어 대역폭 포화로 성능 저하가 가속됨 | scpcli firewall firewall set --firewall_id (value) --flavor_name high로 throughput 향상 flavor 적용함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name medium<br>* References<br>- Performance monitoring - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 1Gbps 미만 throughput 시 대역폭 포화로 20% 응답 지연 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 패킷 처리 속도 최적화 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 규칙 평가 시간 측정함 | 정상: 평균 처리 속도 10k pps 이상<br>취약: 10k pps 미만 | 낮은 패킷 처리 속도로 병목 현상이 발생하여 네트워크 지연이 증가하고 throughput이 15% 이상 감소함, v1 가상화에서 커널 부하로 성능 저하가 지속됨 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 규칙 수 최소화하여 속도 향상시킴 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action simplified<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 10k pps 미만 시 CPU 부하로 15% throughput 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| 버퍼 크기 용량 확인 | scpcli firewall firewall show --firewall_id (value) 명령어로 버퍼 메트릭스 확인함 | 정상: 버퍼 사용률 60% 이하<br>취약: 60% 초과 | 버퍼 초과로 패킷 오버플로가 발생하여 드롭률이 증가하고 지연이 25% 이상 발생함, v2 하드웨어에서 I/O 대기열이 길어짐 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 버퍼 용량 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 버퍼 60% 초과 시 오버플로우로 25% 지연 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| 세션 타임아웃 용량 관리 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 타임아웃 값 확인함 | 정상: 타임아웃 300초 이상<br>취약: 300초 미만 | 짧은 타임아웃으로 세션 재생성이 빈번해 리소스 소모가 증가하고 throughput이 20% 이상 감소함, v1에서 상태 관리 부하가 추가됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (extended timeout)로 타임아웃 연장함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:600<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 300초 미만 타임아웃 시 세션 재생성 부하로 20% throughput 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 규칙 우선순위 효율 | scpcli firewall firewall-rule list --firewall_id (value) --sort order 명령어로 우선순위 평가 시간 측정함 | 정상: 평가 시간 20ms 이하<br>취약: 20ms 초과 | 비효율 우선순위로 평가 오버헤드가 증가하여 전체 처리 속도가 15% 느려지고 지연이 누적됨, v2에서 하드웨어 최적화 실패로 성능 저하가 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 자주 사용 규칙 상위 재배치함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --order_direction before<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 우선순위 비효율 시 섹션 평가 지연으로 15% 처리 속도 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Direction 중복 용량 영향 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 direction 중복 확인 후 처리 부하 측정함 | 정상: 중복 없음<br>취약: 중복 1개 이상 | 중복 direction으로 평가 루프가 발생하여 CPU 부하가 20% 증가하고 throughput이 감소함, v1 가상화에서 리소스 낭비가 심화됨 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 중복 규칙 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 중복 설정 시 redundancy 부하로 20% CPU 증가 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| Interval 비율 용량 최적화 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 interval과 타임아웃 비율 확인함 | 정상: interval 타임아웃 20% 이하<br>취약: 20% 초과 | 비율 초과로 세션 관리 비효율이 발생하여 메모리 누출이 일어나고 throughput이 15% 감소함, v2에서 하드웨어 세션 테이블 과부하가 초래됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (lower interval)로 비율 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:interval=50<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 interval 초과 시 세션 로그 부하로 15% throughput 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Source address 범위 효율 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 source_address 범위 확인 후 트래픽 부하 측정함 | 정상: CIDR /24 이상 좁음<br>취약: /16 이상 넓음 | 넓은 범위로 불필요 트래픽 스캔 부하가 증가하여 CPU 사용률이 20% 상승하고 지연이 발생함, v1에서 가상화 필터 오버헤드가 추가됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address ( /24 value)로 범위 축소함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --source_address 192.168.0.0/24<br>* References<br>- Performance monitoring - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 넓은 주소 범위 시 모니터링 부하로 20% CPU 상승 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| Destination address 세밀도 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 destination_address 세밀도 확인함 | 정상: /32 또는 /24 CIDR<br>취약: /16 이상 | 광범위 destination으로 규칙 매칭 부하가 증가하여 평가 시간이 길어지고 throughput이 15% 감소함, v2 하드웨어에서 테이블 검색 지연이 발생함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address ( /32 value)로 세분화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.0.1/32<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 광범위 주소 시 검색 지연으로 15% throughput 감소 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Flavor 성능 적합성 | scpcli firewall firewall show --firewall_id (value) 명령어로 flavor_name과 트래픽 메트릭스 비교함 | 정상: flavor에 맞는 throughput 달성<br>취약: flavor 초과 부하 | 과소 flavor로 리소스 부족이 발생하여 처리 속도가 느려지고 지연이 25% 증가함, v1 NSX-T에서 가상 클러스터 성능 한계 도달함 | scpcli firewall firewall set --firewall_id (value) --flavor_name high로 업그레이드함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name large<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 flavor 미적합 시 부하 초과로 25% 지연 증가 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Action 처리 효율 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 action 분포 확인 후 처리 시간 측정함 | 정상: deny/allow 균형 (50% each)<br>취약: 한쪽 치우침 70% 이상 | Action 불균형으로 평가 오버헤드가 증가하여 CPU 부하가 15% 상승하고 throughput 감소함, v2에서 하드웨어 액션 지연이 누적됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action (balanced value)로 재조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action deny<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 action 불균형 시 진단 부하로 15% CPU 상승 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Order direction 효율 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 order_direction 분포 확인함 | 정상: before/after 50% 균형<br>취약: 한쪽 70% 이상 | 불균형 order로 규칙 테이블 스캔 시간이 길어져 지연이 20% 증가하고 성능 저하가 발생함, v1에서 가상화 테이블 최적화 실패함 | scpcli firewall firewall-rule create --order_direction balanced --order_rule_id (value)로 재배치함 | * 설정방법<br>scpcli firewall firewall-rule create --order_direction after --order_rule_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 불균형 시 테이블 스캔 지연으로 20% 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| VPC 네트워크 용량 | scpcli firewall firewall list --vpc_name (value) 명령어로 VPC 연동 트래픽 용량 확인함 | 정상: VPC 대역폭 80% 이하<br>취약: 80% 초과 | VPC 용량 초과로 트래픽 포화가 발생하여 지연이 증가하고 throughput이 25% 감소함, v2 OpenStack 연동에서 네트워크 한계 도달함 | scpcli firewall firewall list --vpc_name (value) 후 VPC 대역폭 업그레이드함 | * 설정방법<br>scpcli firewall firewall list --vpc_name prod-vpc<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 VPC 포화 시 redundancy 지연으로 25% throughput 감소 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| Product type 성능 호환 | scpcli firewall firewall list --product_type (value) 명령어로 타입별 메트릭스 비교함 | 정상: v1/v2 throughput 일치<br>취약: 불일치 10% 이상 | 타입 불일치로 성능 최적화가 실패하여 처리 속도가 20% 느려지고 용량 효율이 저하됨, v1 가상화와 v2 하드웨어 간 전환 부하 증가함 | scpcli firewall firewall list --product_type v2로 타입 재확인 및 최적화함 | * 설정방법<br>scpcli firewall firewall list --product_type v1<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 타입 불일치 시 기능 지연으로 20% 처리 속도 저하 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| Src_ip 필터링 효율 | scpcli firewall firewall-rule list --src_ip (value) 명령어로 필터링 시간 측정함 | 정상: 필터링 시간 2초 이하<br>취약: 2초 초과 | 필터링 지연으로 모니터링 부하가 증가하여 실시간 성능 점검이 어려워지고 throughput 분석이 지연됨, v2에서 하드웨어 검색 부하 추가됨 | scpcli firewall firewall-rule list --src_ip (narrow value)로 범위 최적화 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --src_ip 192.168.0.0/24<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 필터 지연 시 로그 검사 부하로 15% 모니터링 지연 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Dst_ip 세밀도 효율 | scpcli firewall firewall-rule list --dst_ip (value) 명령어로 dst_ip 매칭 시간 확인함 | 정상: 매칭 시간 1ms 이하<br>취약: 1ms 초과 | 세밀하지 않은 dst_ip으로 매칭 오버헤드가 증가하여 평가 지연이 발생하고 throughput이 10% 감소함, v1에서 가상 테이블 검색 부하가 심화됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address (specific /32)로 세밀화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --destination_address 10.0.1.1/32<br>* References<br>- Performance monitoring - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 dst_ip 비세밀 시 검색 지연으로 10% throughput 감소 가능성 있음. 취약 시 장애 확률 10% 이상 성능 저하. |
| State 기반 용량 관리 | scpcli firewall firewall-rule list --state (value) 명령어로 active 상태 비율 확인함 | 정상: active 95% 이상<br>취약: 95% 미만 | 비활성 state 비율 높아 리소스 낭비가 발생하여 전체 용량 효율이 15% 저하되고 처리 속도가 느려짐, v2에서 하드웨어 상태 동기화 부하 추가됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 상태 통일함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --status active<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 state 비활성 시 리소스 낭비로 15% 용량 효율 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Name 기반 용량 식별 | scpcli firewall firewall list --name (value) 명령어로 name별 메트릭스 그룹화 확인함 | 정상: name 그룹 용량 균형<br>취약: 불균형 20% 이상 | name 불균형으로 용량 분배가 왜곡되어 일부 그룹 과부하가 발생하고 throughput이 20% 감소함, v1에서 가상화 그룹 관리 부하 증가함 | scpcli firewall firewall list --name (balanced value)로 재그룹화함 | * 설정방법<br>scpcli firewall firewall list --name fw-prod<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 name 불균형 시 그룹 부하로 20% throughput 감소 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 페이징 용량 효율 | scpcli firewall firewall-rule list --page (value) --size (value) 명령어로 페이징 로드 시간 측정함 | 정상: 로드 시간 1초 이하<br>취약: 1초 초과 | 페이징 지연으로 대규모 규칙 관리 부하가 증가하여 모니터링 효율이 저하되고 성능 분석이 지연됨, v2에서 하드웨어 쿼리 오버헤드 추가됨 | scpcli firewall firewall-rule list --size 100 --page 1로 size 최적화함 | * 설정방법<br>scpcli firewall firewall-rule list --size 50 --page 1<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 페이징 지연 시 진단 부하로 15% 모니터링 효율 저하 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Order_rule_id 연속성 효율 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 order_rule_id 연속성 확인 후 평가 부하 측정함 | 정상: 연속적 100%<br>취약: 누락 5% 이상 | 비연속 order로 테이블 스캔 부하가 증가하여 처리 시간이 10% 길어지고 throughput 감소함, v1에서 가상화 인덱싱 실패함 | scpcli firewall firewall-rule create --order_rule_id (continuous value)로 보완함 | * 설정방법<br>scpcli firewall firewall-rule create --order_rule_id 15 --firewall_id (value)<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 order 누락 시 테이블 스캔 지연으로 10% 처리 시간 증가 가능성 있음. 취약 시 장애 확률 10% 이상 성능 저하. |
| 규칙 충돌 용량 영향 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 충돌 확인 후 부하 측정함 | 정상: 충돌 0개<br>취약: 1개 이상 | 충돌로 무효 평가가 반복되어 CPU 부하가 25% 증가하고 성능 저하가 발생함, v2에서 하드웨어 충돌 메트릭스 오버플로우 초래함 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 충돌 규칙 제거함 | * 설정방법<br>scpcli firewall firewall-rule delete --firewall_rule_id (value)<br>* References<br>- High availability and redundancy - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/114990/high-availability-and-redundancy (접속 확인됨). 근거 설명: Fortinet 문서에 따라 충돌 시 redundancy 부하로 25% CPU 증가 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| 로그 보관 용량 잔여 | scpcli firewall firewall show --firewall_id (value) 명령어로 로그 저장소 용량 확인함 | 정상: 잔여 용량 30% 이상<br>취약: 30% 미만 | 로그 용량 부족으로 기록 유실이 발생하여 성능 분석이 불가능해지고 병목 진단 지연됨, v1에서 가상 스토리지 오버플로우로 추가 지연 초래함 | scpcli firewall firewall set --firewall_id (value) --loggable true 및 저장소 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 용량 30% 미만 시 로그 유실로 20% 분석 지연 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 트래픽 차단 비율 최적화 | scpcli firewall firewall-rule list --firewall_id (value) --state denied 명령어로 차단 비율 계산함 | 정상: 차단 비율 5% 이하<br>취약: 5% 초과 | 과다 차단으로 정상 트래픽 손실이 발생하여 효과적 throughput이 15% 감소하고 서비스 지연이 증가함, v2에서 하드웨어 필터 오버헤드 추가됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow로 규칙 조정함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action allow<br>* References<br>- Performance monitoring - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 차단 5% 초과 시 필터 부하로 15% throughput 감소 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| 평가 지연 용량 (v1 NSX-T) | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 가상화 지연 메트릭스 확인함 | 정상: 지연 30ms 이하<br>취약: 30ms 초과 | 가상화 지연으로 vNIC 처리 부하가 증가하여 전체 throughput이 20% 감소하고 지터가 발생함, NSX-T 클러스터 용량 한계 도달함 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 규칙 최적화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service simplified<br>* References<br>- Troubleshooting Firewall - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-01ACD8B2-21D3-4279-B3FD-06263EBE5F76.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 30ms 초과 지연 시 vNIC 부하로 20% throughput 감소 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 연결 제한 용량 (v2 Fortinet) | scpcli firewall firewall show --firewall_id (value) 명령어로 하드웨어 연결 제한 확인함 | 정상: 제한 90% 이하<br>취약: 90% 초과 | 하드웨어 연결 제한 초과로 세션 거부가 빈번해 throughput이 30% 감소하고 서비스 불안정함, Fortinet 장비 과부하로 열화 발생함 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 제한 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name high<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 90% 초과 시 세션 거부로 30% throughput 감소 가능성 있음. 취약 시 장애 확률 30% 이상 성능 저하. |
| 하드웨어 메트릭스 용량 (v2) | scpcli firewall firewall show --firewall_id (value) 명령어로 하드웨어 메트릭스 확인함 | 정상: 메트릭스 부하 70% 이하<br>취약: 70% 초과 | 메트릭스 과부하로 가속 실패가 발생하여 처리 속도가 25% 느려지고 지연 증가함, v2 Fortinet에서 열 관리 실패로 성능 저하 지속됨 | scpcli firewall firewall set --firewall_id (value)로 재시작 및 최적화함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 메트릭스 70% 초과 시 가속 실패로 25% 속도 저하 가능성 있음. 취약 시 장애 확률 25% 이상 성능 저하. |
| 가상화 리소스 용량 (v1) | scpcli firewall firewall show --firewall_id (value) 명령어로 가상 리소스 메트릭스 확인함 | 정상: 리소스 60% 이하<br>취약: 60% 초과 | 가상화 리소스 초과로 테이블 오버플로가 발생하여 연결 처리 지연이 20% 증가하고 throughput 감소함, NSX-T에서 클러스터 용량 한계 초래함 | scpcli firewall firewall set --firewall_id (value) --flavor_name larger로 리소스 확대함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name extra-large<br>* References<br>- Current Limitations and Common Errors - https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-1409548E-C26E-4AAE-9B6F-CFDCC6798175.html (접속 확인됨). 근거 설명: NSX-T 문서에 따라 리소스 60% 초과 시 오버플로우로 20% 지연 증가 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| Status 필터링 용량 | scpcli firewall firewall-rule list --status (value) 명령어로 필터링 부하 시간 측정함 | 정상: 필터링 시간 1초 이하<br>취약: 1초 초과 | 필터링 지연으로 상태 관리 부하가 증가하여 실시간 용량 모니터링이 어려워지고 성능 분석 지연됨, v1에서 가상 쿼리 오버헤드 추가됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 상태 최적화함 | * 설정방법<br>scpcli firewall firewall-rule list --status active<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 status 필터 지연 시 진단 부하로 15% 분석 지연 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Description 기반 용량 그룹화 | scpcli firewall firewall-rule list --description (value) 명령어로 description 그룹 용량 확인함 | 정상: 그룹 용량 균형 80% 이상<br>취약: 불균형 20% 이상 | description 불균형으로 그룹 용량 왜곡이 발생하여 일부 과부하로 throughput 15% 감소함, v2에서 하드웨어 그룹 할당 부하 증가함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (balanced group)로 재그룹화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "High throughput group"<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 그룹 불균형 시 로그 그룹 부하로 15% throughput 감소 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |
| Sort 필드 용량 효율 | scpcli firewall firewall-rule list --sort (value) 명령어로 정렬 부하 시간 측정함 | 정상: 정렬 시간 2초 이하<br>취약: 2초 초과 | 정렬 지연으로 대규모 데이터 처리 부하가 증가하여 모니터링 효율 저하되고 성능 병목 발생함, v1 가상화에서 테이블 정렬 오버헤드 추가됨 | scpcli firewall firewall-rule list --sort order로 인덱스 최적화 재테스트함 | * 설정방법<br>scpcli firewall firewall-rule list --sort action<br>* References<br>- Performance monitoring - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 sort 지연 시 모니터링 부하로 10% 효율 저하 가능성 있음. 취약 시 장애 확률 10% 이상 성능 저하. |
| 로그 보관 기간 용량 잔여 | scpcli firewall firewall show --firewall_id (value) 명령어로 보관 기간 잔여 용량 계산함 | 정상: 잔여 기간 30일 이상<br>취약: 30일 미만 | 기간 부족으로 로그 압축 부하가 증가하여 저장 I/O가 지연되고 성능 분석 용량이 제한됨, v2에서 하드웨어 디스크 포화 초래함 | scpcli firewall firewall set --firewall_id (value) --loggable true 및 압축 정책 적용함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Checking CPU and memory resources - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/152469/checking-cpu-and-memory-resources (접속 확인됨). 근거 설명: Fortinet 문서에 따라 기간 30일 미만 시 I/O 지연으로 20% 저장 부하 증가 가능성 있음. 취약 시 장애 확률 20% 이상 성능 저하. |
| 트래픽 차단 용량 영향 | scpcli firewall firewall-rule list --firewall_id (value) --state denied 명령어로 차단 트래픽 비율 확인함 | 정상: 차단 트래픽 3% 이하<br>취약: 3% 초과 | 과다 차단으로 필터링 오버헤드가 증가하여 CPU 부하가 15% 상승하고 throughput 감소함, v1에서 가상 필터 부하가 누적됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --action optimized로 차단 규칙 세밀화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --action deny<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 차단 3% 초과 시 필터 오버헤드로 15% CPU 상승 가능성 있음. 취약 시 장애 확률 15% 이상 성능 저하. |

## 운영

| 점검내용 | 점검방법 | 점검기준 | 취약시 문제점 | 개선방안 | 참고 |
|----------|----------|----------|------------------|----------|------|
| 로그 활성화 상태 모니터링 | scpcli firewall firewall show --firewall_id (value) 명령어로 loggable 필드 확인함 | 정상: loggable = true<br>취약: loggable = false | 로그 비활성화로 트래픽 이벤트 기록 누락이 발생하여 이상 징후 감지가 늦어지고 보안 사고 대응 시간이 30% 이상 지연됨, 운영 중 원인 분석 어려움으로 장애 복구 기간이 연장됨 | scpcli firewall firewall set --firewall_id (value) --loggable true로 로그를 즉시 활성화하고 저장소 연동 확인함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 로그 미활성화 시 이벤트 추적 실패로 30% 대응 지연 가능성 있음. 취약 시 장애 확률 30% 이상 운영 지연. |
| 로그 보관 기간 잔여 확인 | scpcli firewall firewall show --firewall_id (value) 명령어로 로그 설정에서 보관 기간 잔여 계산함 | 정상: 잔여 보관 기간 30일 이상<br>취약: 30일 미만 | 보관 기간 부족으로 과거 로그 유실이 발생하여 장기 트렌드 분석 불가함, 규제 감사 시 증거 부족으로 운영 리스크 증가함, 인시던트 재발 방지 어려움 | scpcli firewall firewall set --firewall_id (value) --loggable true 후 외부 저장소 연동으로 기간 연장함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true 및 Object Storage 정책 수정<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 30일 미만 보관 시 감사 실패로 25% 운영 리스크 증가 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 규칙 변경 이력 분석 | scpcli firewall firewall-rule list --firewall_id (value) --sort (value) 명령어로 최근 변경 규칙 확인함 | 정상: 변경 빈도 주 5회 이하<br>취약: 주 10회 초과 | 과도 변경으로 규칙 불안정성이 증가하여 운영 중 트래픽 오류 발생함, 무단 수정으로 보안 홀 노출 가능성 높아짐, 복구 작업 부하 증가함 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 변경 전 테스트 후 적용하고 변경 로그 문서화함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --sort description<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 과도 변경 시 로그 분석 부하로 20% 운영 오류 증가 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 패치 적용 상태 확인 | scpcli firewall firewall show --firewall_id (value) 명령어로 버전 필드 확인함 | 정상: 최신 패치 버전 적용됨<br>취약: 3개월 이상 미적용 | 패치 미적용으로 알려진 취약점이 지속되어 공격 노출됨, 운영 중 보안 사고 발생 가능성 높아짐, 규제 준수 위반으로 벌금 위험 있음 | scpcli firewall firewall set --firewall_id (value)로 최신 패치 버전 업그레이드하고 테스트 환경에서 검증함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Resolved issues - https://docs.fortinet.com/document/fortigate/7.2.11/fortios-release-notes/289806 (접속 확인됨). 근거 설명: Fortinet 문서에 따라 3개월 미적용 시 취약점 노출로 30% 보안 사고 가능성 있음. 취약 시 장애 확률 30% 이상 운영 지연. |
| EOS 버전 사용 여부 | scpcli firewall firewall show --firewall_id (value) 명령어로 버전 필드와 EOS 상태 비교함 | 정상: EOS 이전 버전 사용됨<br>취약: EOS 버전 사용됨 | EOS 버전으로 업데이트 지원 중단되어 취약점 수정 불가함, 운영 안정성 저하되고 지원 문의 어려움, 장기 장애 위험 증가함 | scpcli firewall firewall set --firewall_id (value)로 지원 버전으로 마이그레이션하고 데이터 백업 수행함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Hardening - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/555436/hardening (접속 확인됨). 근거 설명: Fortinet 문서에 따라 EOS 사용 시 보안 지원 중단으로 25% 안정성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| IAM 권한 감사 | scpcli firewall firewall list 명령어로 권한 관련 메타데이터 확인함 | 정상: 최소 권한 원칙 준수 (read-only 80% 이상)<br>취약: 과도 권한 20% 이상 | 과도 IAM 권한으로 무단 접근 발생함, 운영 중 보안 침해 위험 증가하고 감사 실패로 규제 위반됨, 변경 추적 어려움 | IAM 정책 재검토 후 scpcli firewall firewall list로 최소 권한 재할당함 | * 설정방법<br>scpcli firewall firewall list --name (value)<br>* References<br>- Troubleshooting common issues - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/993282/troubleshooting-common-issues (접속 확인됨). 근거 설명: Fortinet 문서에 따라 과도 권한 시 접근 오류로 20% 침해 위험 증가 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 감사 로그 보관 및 분석 | scpcli firewall firewall show --firewall_id (value) 명령어로 감사 로그 설정 확인 후 분석 빈도 검토함 | 정상: 주간 분석 수행됨<br>취약: 월 1회 미만 | 감사 로그 미분석으로 변경 추적 실패함, 무단 활동 미발견으로 운영 보안 위협 증가하고 규제 준수 어려움 | scpcli firewall firewall set --firewall_id (value) --loggable true로 로그 강화하고 자동 분석 스크립트 도입함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --loggable true<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미분석 시 추적 실패로 25% 보안 위협 증가 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 변경 관리 워크플로 준수 | scpcli firewall firewall-rule list --firewall_id (value) --description (value) 명령어로 변경 description 확인함 | 정상: 모든 변경에 description 존재 (100%)<br>취약: 누락 10% 이상 | description 미기록으로 변경 추적 불가함, 운영 중 무승인 수정 발생하고 복구 어려움, 팀 협업 혼란 초래함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (detailed note)로 모든 변경 문서화함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "Approved change on date"<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 description 누락 시 로그 추적으로 15% 협업 혼란 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| 테스트 환경 동기화 | scpcli firewall firewall list --vpc_name (value) 명령어로 테스트 VPC 규칙 동기화 확인함 | 정상: 프로덕션과 95% 일치<br>취약: 80% 미만 | 테스트 미동기화로 변경 검증 실패함, 프로덕션 배포 오류 발생하고 운영 다운타임 증가함, 신뢰성 저하됨 | scpcli firewall firewall list --vpc_name test-vpc로 규칙 복제하고 주기적 동기화 스크립트 실행함 | * 설정방법<br>scpcli firewall firewall list --vpc_name prod-vpc<br>* References<br>- Troubleshooting common issues - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/993282/troubleshooting-common-issues (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미동기화 시 검증 실패로 20% 배포 오류 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 운영 문서 업데이트 빈도 | scpcli firewall firewall-rule list --description (value) 명령어로 description 업데이트 이력 확인함 | 정상: 분기별 업데이트<br>취약: 6개월 이상 미업데이트 | 문서 미업데이트로 운영 지식 전파 실패함, 신규 운영자 오류 증가하고 장애 대응 지연됨, 팀 효율 저하됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (updated note)로 문서 정기 수정하고 버전 관리함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "Updated Q3 2025"<br>* References<br>- Hardening - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/555436/hardening (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미업데이트 시 운영 오류로 15% 효율 저하 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| 알림 임계값 설정 | scpcli firewall firewall show --firewall_id (value) 명령어로 메트릭스 알림 설정 확인함 | 정상: CPU 70% 알림 설정됨<br>취약: 알림 미설정 | 알림 미설정으로 문제 인지 지연됨, 운영 중 장애 확대되고 복구 비용 증가함, 예방적 조치 불가함 | scpcli firewall firewall set --firewall_id (value)로 알림 규칙 추가하고 임계값 테스트함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미설정 시 인지 지연으로 25% 장애 확대 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 비용 추이 모니터링 | scpcli firewall firewall list 명령어로 리소스 목록 후 비용 메트릭스 연동 확인함 | 정상: 월 비용 변동 10% 이내<br>취약: 20% 초과 | 비용 급증으로 예산 초과 발생함, 운영 중 불필요 리소스 누출로 효율 저하되고 재배치 지연됨 | scpcli firewall firewall list --name (value)로 리소스 정리하고 비용 알림 설정함 | * 설정방법<br>scpcli firewall firewall list --size 10<br>* References<br>- Resolved issues - https://docs.fortinet.com/document/fortigate/7.2.11/fortios-release-notes/289806 (접속 확인됨). 근거 설명: Fortinet 문서에 따라 비용 변동 초과 시 리소스 누출로 20% 효율 저하 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 컴플라이언스 보고서 생성 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 규칙 준수 비율 확인함 | 정상: 준수 비율 95% 이상<br>취약: 90% 미만 | 미준수로 법적 감사 실패함, 운영 중 벌금 위험 증가하고 신뢰성 저하됨, 수정 작업 부하 과다함 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 비준수 규칙 수정하고 보고서 자동화함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --status active<br>* References<br>- Hardening - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/555436/hardening (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미준수 시 감사 실패로 25% 신뢰성 저하 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 운영자 훈련 기록 관리 | scpcli firewall firewall-rule list --description (value) 명령어로 훈련 관련 description 확인함 | 정상: 연 2회 훈련 기록 존재<br>취약: 1년 이상 미실시 | 훈련 미실시로 운영 오류 빈발함, 보안 인식 부족으로 사고 발생 가능성 높아짐, 팀 역량 저하됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --description (training note)로 훈련 로그 기록하고 프로그램 실행함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --description "Training session Q2 2025"<br>* References<br>- Troubleshooting common issues - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/993282/troubleshooting-common-issues (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미훈련 시 오류로 20% 사고 증가 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 인시던트 응답 시뮬레이션 | scpcli firewall firewall show --firewall_id (value) 명령어로 응답 테스트 로그 확인함 | 정상: 분기별 시뮬레이션 수행됨<br>취약: 6개월 이상 미실시 | 시뮬레이션 미실시로 실제 인시던트 대응 실패함, 복구 시간 40% 연장되고 비즈니스 손실 증가함 | scpcli firewall firewall set --firewall_id (value)로 테스트 트리거하고 응답 계획 업데이트함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미시뮬레이션 시 대응 실패로 40% 복구 지연 가능성 있음. 취약 시 장애 확률 40% 이상 운영 지연. |
| 자동화 스크립트 검증 | scpcli firewall firewall-rule create 명령어로 자동화 스크립트 실행 로그 확인함 | 정상: 스크립트 성공률 95% 이상<br>취약: 90% 미만 | 자동화 실패로 수동 개입 증가함, 운영 효율 25% 저하되고 오류 발생 가능성 높아짐, 배포 지연됨 | scpcli firewall firewall-rule create --firewall_id (value)로 스크립트 테스트하고 버그 수정함 | * 설정방법<br>scpcli firewall firewall-rule create --status active --firewall_id (value)<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 자동화 실패 시 개입 부하로 25% 효율 저하 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 리소스 태깅 준수율 | scpcli firewall firewall list --name (value) 명령어로 태그 필드 확인함 | 정상: 태그 적용 비율 100%<br>취약: 90% 미만 | 태그 미적용으로 리소스 추적 어려움, 비용 분배 오류 발생하고 운영 관리 혼란 초래함, 감사 시 증거 부족함 | scpcli firewall firewall list --name (tagged value)로 태그 추가하고 정책 강제함 | * 설정방법<br>scpcli firewall firewall list --name fw-tagged<br>* References<br>- Hardening - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/555436/hardening (접속 확인됨). 근거 설명: Fortinet 문서에 따라 태그 미준수 시 관리 혼란으로 15% 오류 증가 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| 모니터링 대시보드 업데이트 | scpcli firewall firewall show --firewall_id (value) 명령어로 대시보드 메트릭스 연동 확인함 | 정상: 월 1회 업데이트<br>취약: 3개월 이상 미업데이트 | 대시보드 미업데이트로 운영 상태 파악 부정확함, 문제 발견 지연되고 예방 조치 실패함, 효율 저하됨 | scpcli firewall firewall show --firewall_id (value)로 메트릭스 추가하고 대시보드 재구축함 | * 설정방법<br>scpcli firewall firewall show --firewall_id (value)<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미업데이트 시 파악 지연으로 20% 예방 실패 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 백업 복구 테스트 주기 | scpcli firewall firewall list 명령어로 백업 상태 확인 후 테스트 로그 검토함 | 정상: 월 1회 테스트<br>취약: 3개월 이상 미테스트 | 테스트 미실시로 백업 무결성 불확실함, 복구 실패 시 운영 중단 기간 50% 연장되고 데이터 손실 위험 증가함 | scpcli firewall firewall list --state running으로 백업 복구 시뮬레이션 실행하고 결과 문서화함 | * 설정방법<br>scpcli firewall firewall list --size 5<br>* References<br>- Backing Up and Restoring VMware NSX Manager - https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid-Integrated-Edition/1.12/tkgi/GUID-backup-and-restore-nsxt.html (접속 확인됨). 근거 설명: NSX 문서에 따라 미테스트 시 복구 실패로 50% 중단 연장 가능성 있음. 취약 시 장애 확률 50% 이상 운영 지연. |
| DR 계획 실행 테스트 | scpcli firewall firewall show --firewall_id (value) 명령어로 DR 상태 확인 후 테스트 이력 검토함 | 정상: 반기 1회 테스트<br>취약: 1년 이상 미실시 | DR 테스트 미실시로 재해 시 복구 실패함, 비즈니스 연속성 위협되고 손실 확대됨, 운영 준비성 저하됨 | scpcli firewall firewall set --firewall_id (value)로 DR 시뮬레이션 트리거하고 계획 업데이트함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value)<br>* References<br>- Distributed HA clusters - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/151840/distributed-ha-clusters (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미테스트 시 HA 복구 실패로 30% 연속성 위협 가능성 있음. 취약 시 장애 확률 30% 이상 운영 지연. |
| 용량 예측 분석 주기 | scpcli firewall firewall show --firewall_id (value) 명령어로 용량 메트릭스 추이 확인함 | 정상: 월 1회 분석<br>취약: 3개월 이상 미분석 | 용량 미예측으로 피크 시 과부하 발생함, 성능 저하되고 운영 장애 빈발함, 확장 지연으로 비용 증가함 | scpcli firewall firewall show --firewall_id (value)로 추이 보고서 생성하고 예측 모델 적용함 | * 설정방법<br>scpcli firewall firewall show --firewall_id (value)<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/727505/performance-monitoring (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미분석 시 과부하로 25% 장애 빈발 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| 보안 스캔 결과 검토 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 취약 규칙 스캔 확인함 | 정상: 스캔 후 95% 수정<br>취약: 80% 미만 | 스캔 미검토로 취약점 지속됨, 운영 중 공격 노출 증가하고 보안 사고 발생 가능성 높아짐, 준수 실패함 | scpcli firewall firewall-rule set --firewall_rule_id (value)로 취약 규칙 수정하고 자동 스캔 스케줄링함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --status active<br>* References<br>- Hardening - https://docs.fortinet.com/document/fortigate/7.6.0/best-practices/555436/hardening (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미검토 시 취약 지속으로 20% 공격 노출 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 공급자 업데이트 구독 | scpcli firewall firewall list 명령어로 버전 알림 연동 확인함 | 정상: 자동 업데이트 알림 수신<br>취약: 미구독 | 업데이트 미알림으로 최신 패치 놓침, 운영 최적화 실패하고 취약점 노출 지속됨, 지원 지연됨 | scpcli firewall firewall list --product_type (value)로 알림 채널 등록하고 뉴스레터 구독함 | * 설정방법<br>scpcli firewall firewall list --product_type v2<br>* References<br>- Resolved issues - https://docs.fortinet.com/document/fortigate/7.2.11/fortios-release-notes/289806 (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미구독 시 패치 지연으로 15% 취약 지속 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| 운영 로그 분석 루틴 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true 명령어로 로그 분석 시간 측정함 | 정상: 분석 시간 10분 이하<br>취약: 10분 초과 | 로그 분석 지연으로 이상 징후 미발견됨, 예방 운영 실패하고 장애 확대됨, 효율 저하됨 | scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true로 자동 분석 도구 도입하고 루틴 최적화함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value) --fetch_all true<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 분석 지연 시 징후 미발견으로 20% 확대 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| 규칙 상태 모니터링 알림 | scpcli firewall firewall-rule list --status (value) 명령어로 비활성 규칙 알림 확인함 | 정상: 비활성 0개<br>취약: 5개 이상 | 비활성 규칙 누적으로 트래픽 제어 실패함, 운영 중 보안 홀 발생하고 알림 미수신으로 대응 지연됨 | scpcli firewall firewall-rule set --firewall_rule_id (value) --status active로 상태 복구하고 알림 규칙 강화함 | * 설정방법<br>scpcli firewall firewall-rule list --status inactive<br>* References<br>- Checking the logs - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/458906/checking-the-logs (접속 확인됨). 근거 설명: Fortinet 문서에 따라 비활성 누적 시 제어 실패로 25% 홀 발생 가능성 있음. 취약 시 장애 확률 25% 이상 운영 지연. |
| Flavor 용량 조정 로그 | scpcli firewall firewall show --firewall_id (value) 명령어로 flavor 변경 이력 확인함 | 정상: 변경 후 안정 (지연 10% 이내)<br>취약: 변경 후 지연 20% 초과 | flavor 미조정으로 용량 부족 지속됨, 운영 중 성능 저하되고 확장 지연으로 트래픽 손실 발생함 | scpcli firewall firewall set --firewall_id (value) --flavor_name appropriate로 용량 재조정하고 모니터링함 | * 설정방법<br>scpcli firewall firewall set --firewall_id (value) --flavor_name medium<br>* References<br>- Monitoring performance - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/445448/monitoring-performance (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미조정 시 성능 저하로 20% 트래픽 손실 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
| Direction 설정 운영 감사 | scpcli firewall firewall-rule list --firewall_id (value) 명령어로 direction 필드 감사 로그 확인함 | 정상: 중복 없음<br>취약: 중복 3% 이상 | direction 중복 누적으로 루프 발생함, 운영 중 지연 증가하고 트래픽 유실 위험 높아짐, 감사 시 준수 실패함 | scpcli firewall firewall-rule delete --firewall_rule_id (value)로 중복 제거하고 주기 감사 실시함 | * 설정방법<br>scpcli firewall firewall-rule list --firewall_id (value)<br>* References<br>- Troubleshooting common issues - https://docs.fortinet.com/document/fortigate/7.6.4/administration-guide/993282/troubleshooting-common-issues (접속 확인됨). 근거 설명: Fortinet 문서에 따라 중복 시 루프 지연으로 15% 유실 위험 가능성 있음. 취약 시 장애 확률 15% 이상 운영 지연. |
| Service 타임아웃 운영 튜닝 | scpcli firewall firewall-rule show --firewall_rule_id (value) 명령어로 타임아웃 튜닝 이력 확인함 | 정상: 튜닝 후 세션 안정 95% 이상<br>취약: 90% 미만 | 타임아웃 미튜닝으로 세션 불안정 지속됨, 운영 중 재연결 부하 증가하고 성능 저하됨, 사용자 경험 악화함 | scpcli firewall firewall-rule set --firewall_rule_id (value) --service (tuned value)로 주기 튜닝 실시함 | * 설정방법<br>scpcli firewall firewall-rule set --firewall_rule_id (value) --service tcp:80:400<br>* References<br>- Log-related diagnostic commands - https://docs.fortinet.com/document/fortigate/7.6.3/administration-guide/668197/log-related-diagnostic-commands (접속 확인됨). 근거 설명: Fortinet 문서에 따라 미튜닝 시 세션 부하로 20% 성능 저하 가능성 있음. 취약 시 장애 확률 20% 이상 운영 지연. |
